name: linter

on: [push]


jobs:
  test_linter:

    runs-on: ubuntu-18.04

    steps:
    - uses: actions/checkout@v2
# Пакет для доступа гитэкшна в мой репозиторий
    - name: Setup PHP
      uses: shivammathur/setup-php@v1
# Пакет с PHP для тестов
      with:
        php_version: '7.4'
    - name: Install package
      run: make install
    - name: Start linter
      run: make lint
    - name: Start phpunit test
      run: make test
# Кодклимат
    - name: Test & publish code coverage
      uses: paambaati/codeclimate-action@v2.6.0 
      env:
        CC_TEST_REPORTER_ID: 1f7150adcf4f6670ecb168f5d79200376256ec3caa395d3851acda6ceff65226
      with:
        coverageCommand: make test
        debug: true
