name: linter and tests

on:
    - push
    - pull_request

jobs:
  test_linter:

    runs-on: ubuntu-18.04

    steps:
    - uses: actions/checkout@v2
    - name: Setup PHP
      uses: shivammathur/setup-php@v2
# Linter
      with:
        php-version: '7.4'
    - name: Install package
      run: make install
    - name: Start linter
      run: make lint
# Code_climate
    - name: Run test & publish code coverage
      uses: paambaati/codeclimate-action@v2.6.0 
      env:
        CC_TEST_REPORTER_ID: 1f7150adcf4f6670ecb168f5d79200376256ec3caa395d3851acda6ceff65226
      with:
        coverageCommand: make test-coverage
        debug: true
